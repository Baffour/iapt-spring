{{rc = request.controller}}
{{rf = request.function}}
{{ra = request.args}}
<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8">
    <title>{{if response.title:}}{{=response.title}} | {{pass}}{{=APP_NAME}}</title>

    <link rel="stylesheet" href="{{=URL('static','css/bootstrap.min.css')}}"/>
    <link rel="stylesheet" href="{{=URL('static','css/bootstrap-theme.min.css')}}"/>

    <link rel="stylesheet" href="{{=URL('static','css/bootstrap-overrides.css')}}"/>
    <link rel="stylesheet" href="{{=URL('static','css/application.css')}}"/>

    <script src="{{=URL('static','js/modernizr-2.8.3.min.js')}}"></script>
    <script src="{{=URL('static','js/jquery.js')}}"></script>
    <script src="{{=URL('static','js/web2py.js')}}"></script>
    <script src="{{=URL('static','js/bootstrap.min.js')}}"></script>
    <script>
    $(document).ready(function(){
        $('[data-toggle="tooltip"]').tooltip();
    });
    </script>
  </head>
  <body>
    <nav class="navbar navbar-default">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <a href="/{{=request.application}}/" class="navbar-brand">{{=APP_NAME}}</a>

            <ul class="nav navbar-nav">
              <li {{if rc == 'find' and rf == 'explore':}}class="active"{{pass}}>
                <a href="{{=URL('find', 'explore')}}">Explore</a>
              </li>
            </ul>

            <form class="navbar-form navbar-left search-form"
                  enctype="multipart/form-data" action="{{=URL('find','search')}}">
              <label for="search-query" class="hide-label">Search Query</label>
              <div class="input-group" role="search">
                <input id="search-query" name="query" type="text" class="form-control" placeholder="Search...">
                <span class="input-group-btn">
                  <button id="search-submit" type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span><span class="btn-label">Search</span></button>
                </span>
              </div>
            </form>

            <ul class="nav navbar-nav navbar-right">
              {{if auth.user:}}
              <li {{if rc == 'box':}}class="active"{{pass}}>
                <a href="{{=URL('box', 'list')}}">My Boxes</a>
              </li>
              <li {{if rc == 'trade':}}class="active"{{pass}}>
                <a href="{{=URL('trade', 'list')}}">My Trades</a>
              </li>
              <li class="dropdown">
                <a href="#" data-toggle="dropdown">
                  My Lists
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-left">
                  <li><a href="{{=URL('want', 'view', args=auth.user.id)}}">
                    My Want List<br />
                    <small>(items I'd like to acquire)</small>
                  </a></li>
                  <li><a href="{{=URL('have', 'view', args=auth.user.id)}}">
                    My Have List<br />
                    <small>(items I'd like to trade away)</small>
                  </a></li>
                </ul>
              </li>
              {{if not rc == 'admin':}}
              <li {{if rc == 'notification':}}class="active"{{pass}}>
                {{ncount = notification_count()}}
                <a href="{{=URL('notification', 'inbox')}}">
                  <div id="notif-label" class="label {{='label-warning' if ncount else 'label-inactive'}}">
                    <span class="glyphicon glyphicon-bell"></span><span>{{=ncount}}</span>
                  </div></a>
              </li>
              {{pass}}
              <li class="dropdown">
                <a href="{{=URL('default', 'user/profile')}}" data-toggle="dropdown">
                  <span class="dropdown-user-icon glyphicon glyphicon-user"></span>
                  <span class="reader-only">User</span>
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu">
                  <li><a><strong>User: </strong>{{=auth.user.username}}</a> </li>
                  <li><a role="menuitem" href="{{=URL('default', 'user/profile')}}">Edit profile</a></li>
                  <li><a role="menuitem" href="{{=URL('default', 'user/change_password')}}">Change password</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a role="menuitem" href="{{=URL('default', 'user/logout')}}">Sign out</a></li>
                </ul>
              </li>
              {{else:}}
              <li {{if rc == 'default' and rf == 'user' and ra[0] == 'register':}}class="active"{{pass}}>
                <a href="{{=URL('default', 'user/register')}}">Register</a>
              </li>
              <li {{if rc == 'default' and rf == 'user' and ra[0] == 'login':}}class="active"{{pass}}>
                <a href="{{=URL('default', 'user/login')}}">Login</a>
              </li>
              {{pass}}
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <div id="main" class="container">
      <div class="row">
        <div class="col-xs-12">
          {{if response.flash:}}
            <div class="alert alert-{{=response.flash_type or session.flash_type or 'warning'}} flash">
              {{=XML(response.flash)}}
            </div>
          {{pass}}

          {{include}}
          {{pass}}
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="footer-text">&copy; IAPT1516 Group 13</p>
      </div>
    </footer>
  </body>
</html>
